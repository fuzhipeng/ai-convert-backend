# AI文档转换系统

## 后端开发进度

### 基础功能
- [x] Spring Boot项目搭建
- [x] MySQL数据库集成
- [x] MyBatis配置
- [x] 基础CRUD接口
- [x] 文件上传功能
- [x] 实体类定义

### 数据库表
- [x] file_upload表
- [x] conversion_record表
- [x] user表（新增points积分字段）
- [x] user_points表（用户积分关联表）
- [x] orders表（订单表）
- [x] subscription表（订阅表）

### 已实现接口
- [x] 文件上传接口
- [x] 文件转换接口
- [x] 转换记录查询接口
- [x] 用户积分查询接口（直接从User表查询，无需联表）
- [x] 用户登录/注册接口（支持谷歌登录）
- [x] 创建结账会话接口（对接Creem支付平台）
- [x] 验证支付状态接口
- [x] 查询用户订阅接口
- [x] 取消订阅接口
- [x] 支付回调接口

### 用户系统
- [x] 谷歌账号登录集成
- [x] 用户注册时初始化积分（30积分）
- [x] 用户积分管理
- [x] 用户信息查询

### 支付系统
- [x] Creem支付平台集成
- [x] 订单管理
- [x] 订阅管理
- [x] 支付状态查询
- [x] 支付回调处理

### 文件处理功能
- [x] 智能文件编码检测（UTF-8、UTF-16、GBK等）
- [x] 多重编码尝试机制
- [x] 内容质量验证，避免乱码
- [x] DOCX文件处理（使用Apache POI）
- [x] 文件内容预览

### Claude API集成
- [x] 优化API调用结构
- [x] 系统消息使用配置文件中的提示词
- [x] 详细的API调用日志
- [x] Token使用统计
- [x] 错误处理和重试机制

### 技术栈
- Spring Boot 3.2.3
- MySQL 8.0
- MyBatis
- Maven
- Java 17
- Apache POI 5.2.3

### 待开发功能
- [ ] 用户认证系统
- [ ] 文件存储优化
- [ ] 转换进度跟踪
- [ ] 错误处理机制
- [ ] API文档完善
- [ ] 单元测试覆盖

## 后端更新日志
- 2024-03-23: 新增支付系统，对接Creem支付平台，实现订单和订阅管理
- 2024-03-22: 在User表中添加积分points字段，初始值30
- 2024-03-22: 优化用户积分查询，不再需要联表
- 2024-03-21: 创建项目基础结构
- 2024-03-21: 实现文件上传和转换功能
- 2024-03-16: 添加Claude API集成 